<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Management of Cancer-Associated Thrombosis</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Urbanist:wght@700;800&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        :root {
            --bg-dark: #0f172a;
            --slide-bg: #1e293b;
            --accent: #deff9a;
            --text-main: #f8fafc;
            --text-dim: #94a3b8;
            --danger: #ef4444;
            --font-h1: 70px;
            --font-h2: 45px;
            --font-body: 28px;
            --font-small: 20px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        #presentation-wrapper {
            width: 1280px;
            height: 720px;
            background: var(--slide-bg);
            position: relative;
            box-shadow: 0 50px 100px -20px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            border: 1px solid #334155;
        }

        #drawing-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 50;
            pointer-events: none;
            cursor: crosshair;
        }

        .progress-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 8px;
            background: #334155;
            z-index: 60;
        }
        #progress-bar {
            height: 100%;
            background: var(--accent);
            width: 0%;
            transition: width 0.3s ease;
        }

        .slide {
            display: none;
            width: 100%;
            height: 100%;
            padding: 40px 60px;
            flex-direction: column;
            justify-content: flex-start;
            animation: fadeIn 0.4s ease;
        }
        .slide.active { display: flex; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 { font-family: 'Urbanist', sans-serif; font-size: var(--font-h1); line-height: 1.1; margin-bottom: 20px; color: var(--accent); }
        h2 { font-family: 'Urbanist', sans-serif; font-size: var(--font-h2); color: var(--accent); margin-bottom: 25px; border-left: 12px solid var(--accent); padding-left: 25px; }
        p { font-size: var(--font-body); line-height: 1.4; margin-bottom: 12px; }
        ul { list-style: none; }
        li { font-size: var(--font-body); margin-bottom: 15px; display: flex; align-items: flex-start; }
        li i { color: var(--accent); margin-right: 15px; margin-top: 8px; font-size: 0.8em; }

        .subtitle { font-size: 34px; color: var(--text-dim); }

        .data-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: #334155; padding: 20px; border-radius: 20px; border: 1px solid #475569; }
        .card h3 { font-size: 24px; color: var(--accent); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; }
        
        .alert-box { 
            background: rgba(239, 68, 68, 0.1); 
            border: 3px solid var(--danger); 
            padding: 20px; 
            border-radius: 15px;
            margin-top: 10px;
        }

        table { width: 100%; border-collapse: collapse; margin-top: 5px; }
        th { font-size: 18px; padding: 12px; background: var(--accent); color: #000; text-align: left; }
        td { font-size: 18px; padding: 12px; border-bottom: 1px solid #475569; }

        .controls {
            position: absolute;
            bottom: 25px;
            right: 60px;
            display: flex;
            gap: 10px;
            z-index: 100;
        }
        .nav-btn {
            background: var(--accent);
            color: #000;
            border: none;
            padding: 8px 20px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .nav-btn:hover { transform: scale(1.05); filter: brightness(1.1); }
        .nav-btn:disabled { background: #475569; color: #94a3b8; cursor: not-allowed; }
        
        .pen-btn { background: #475569; color: white; }
        .pen-btn.active { background: var(--danger); box-shadow: 0 0 15px rgba(239, 68, 68, 0.4); }

        .slide-counter { position: absolute; bottom: 35px; left: 60px; font-size: 16px; color: var(--text-dim); font-weight: 700; letter-spacing: 2px; }
    </style>
</head>
<body>

<div id="presentation-wrapper">
    <div class="progress-container"><div id="progress-bar"></div></div>
    <canvas id="drawing-canvas" width="1280" height="720"></canvas>

    <!-- Slide 1: Title -->
    <div class="slide active" id="slide-0">
        <div style="height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;">
            <h1>Management of <br><span>Cancer-Associated Thrombosis</span></h1>
            <p class="subtitle">Ted Kong, MD</p>
            <p style="margin-top: 30px; font-size: 22px; color: var(--text-dim);">Evidence-based protocols from UpToDate & clinical trials</p>
        </div>
    </div>

    <!-- Slide 2: Epidemiology -->
    <div class="slide" id="slide-1">
        <h2>Burden and Impact</h2>
        <div class="data-grid">
            <div class="card">
                <h3>Mortality Rank</h3>
                <p>Venous Thromboembolism is the <strong>second leading cause of death</strong> in cancer patients.</p>
                <p style="font-size: 22px; color: var(--text-dim);">Survival relative risk: <strong>3.7</strong> for death in the first year.</p>
            </div>
            <div class="card">
                <h3>High-Risk Sites</h3>
                <p><strong>Very High Risk:</strong> Pancreas (body/tail >50% incidence), Stomach.</p>
                <p><strong>High Risk:</strong> Glioblastoma, Lung, Ovarian, Renal Cell Carcinoma.</p>
            </div>
        </div>
        <p style="margin-top: 20px; font-style: italic; font-size: 24px;">"Timing is critical: 80% of events occur in the outpatient setting during chemotherapy."</p>
    </div>

    <!-- Slide 3: Pathophysiology -->
    <div class="slide" id="slide-2">
        <h2>Pathophysiology: Malignancy Drivers</h2>
        <div class="card" style="margin-top: 10px; padding: 25px;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <div style="display: flex; gap: 20px;">
                    <i class="fa-solid fa-dna" style="color: var(--accent); font-size: 28px; margin-top: 5px;"></i>
                    <div>
                        <p style="font-size: 24px; line-height: 1.3; margin-bottom: 5px;"><strong>Tissue Factor:</strong></p>
                        <p style="font-size: 22px; line-height: 1.2; color: var(--text-dim);">Tumor cells and stroma express high levels of Tissue Factor.</p>
                    </div>
                </div>
                <div style="display: flex; gap: 20px;">
                    <i class="fa-solid fa-circle-nodes" style="color: var(--accent); font-size: 28px; margin-top: 5px;"></i>
                    <div>
                        <p style="font-size: 24px; line-height: 1.3; margin-bottom: 5px;"><strong>Microparticles:</strong></p>
                        <p style="font-size: 22px; line-height: 1.2; color: var(--text-dim);">Particles activate Factor X directly in the blood.</p>
                    </div>
                </div>
                <div style="display: flex; gap: 20px;">
                    <i class="fa-solid fa-compress" style="color: var(--accent); font-size: 28px; margin-top: 5px;"></i>
                    <div>
                        <p style="font-size: 24px; line-height: 1.3; margin-bottom: 5px;"><strong>Mechanical:</strong></p>
                        <p style="font-size: 22px; line-height: 1.2; color: var(--text-dim);">Bulk lymphadenopathy compresses major veins.</p>
                    </div>
                </div>
                <div style="display: flex; gap: 20px;">
                    <i class="fa-solid fa-shield-virus" style="color: var(--accent); font-size: 28px; margin-top: 5px;"></i>
                    <div>
                        <p style="font-size: 24px; line-height: 1.3; margin-bottom: 5px;"><strong>Vessel Invasion:</strong></p>
                        <p style="font-size: 22px; line-height: 1.2; color: var(--text-dim);">Direct invasion of large vessels (e.g., Renal Cell).</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 4: Khorana Score -->
    <div class="slide" id="slide-3">
        <h2>Risk Assessment: Khorana Score</h2>
        <table>
            <thead>
                <tr>
                    <th>Clinical Parameter</th>
                    <th>Points</th>
                    <th>6-Month Risk</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Stomach or Pancreas Primary Tumor</td>
                    <td>2</td>
                    <td><strong>High (≥3):</strong> ~17.7%</td>
                </tr>
                <tr>
                    <td>Lung, Lymphoma, Bladder, Testicular, Gynecologic</td>
                    <td>1</td>
                    <td><strong>Intermediate (1-2):</strong> ~9.6%</td>
                </tr>
                <tr>
                    <td>Platelets ≥350k | White Cells >11k | Hemoglobin <10</td>
                    <td>1 each</td>
                    <td rowspan="2" style="background: rgba(222, 255, 154, 0.05); text-align: center; vertical-align: middle;">
                        <strong>AVERT Trial NNT:</strong> 17<br>
                        <strong>CASSINI Trial NNT:</strong> 24
                    </td>
                </tr>
                <tr>
                    <td>Body Mass Index ≥35 kg/m²</td>
                    <td>1</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Slide 5: Primary Prophylaxis -->
    <div class="slide" id="slide-4">
        <h2>Primary Prophylaxis Evidence</h2>
        <div class="card">
            <h3>Outpatients (Ambulatory)</h3>
            <p>Favor prophylaxis if <strong>Khorana Score ≥ 2</strong> using Direct Oral Anticoagulants (Apixaban 2.5mg twice daily or Rivaroxaban 10mg Daily).</p>
        </div>
        <div class="card" style="margin-top: 15px;">
            <h3>Inpatients (Hospitalized Medical)</h3>
            <p>Use <strong>Low Molecular Weight Heparin</strong> (Enoxaparin 40mg Daily) for duration of stay in patients with reduced mobility.</p>
        </div>
    </div>

    <!-- Slide 6: Postoperative Guidelines -->
    <div class="slide" id="slide-5">
        <h2>Postoperative Guidelines</h2>
        <div class="data-grid">
            <div class="card">
                <h3>Standard Duration</h3>
                <p><strong>10 to 14 days</strong></p>
                <p style="font-size: 22px; color: var(--textDim);">For major cancer surgeries (Thoracic, Head/Neck) to cover the period of highest risk.</p>
            </div>
            <div class="card" style="border-color: var(--accent);">
                <h3>Extended Duration</h3>
                <p><strong>28 days (4 weeks)</strong></p>
                <p style="font-size: 22px; color: var(--text-dim);">Mandatory for major <strong>Abdominal or Pelvic</strong> cancer surgery due to high risk of late events.</p>
            </div>
        </div>
        <div class="alert-box" style="margin-top: 15px; border-color: var(--accent);">
            <p style="font-size: 22px; text-align: center;">Extended duration reduces symptomatic clots by >50% in high-risk sites.</p>
        </div>
    </div>

    <!-- Slide 7: First-Line Treatment -->
    <div class="slide" id="slide-6">
        <h2>Treatment Selection</h2>
        <div class="card">
            <h3>Direct Oral Anticoagulants (Preferred)</h3>
            <p><strong>Apixaban (CARAVAGGIO Trial):</strong> Non-inferior recurrence to Dalteparin; safe gastrointestinal profile.</p>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
            <div class="card" style="background: rgba(239, 68, 68, 0.05);">
                <h3>Rivaroxaban</h3>
                <p style="font-size: 22px;">Lower recurrence; higher non-major bleeding in <strong>upper gastrointestinal</strong> cancers.</p>
            </div>
            <div class="card" style="background: rgba(239, 68, 68, 0.05);">
                <h3>Edoxaban</h3>
                <p style="font-size: 22px;">Requires heparin lead-in; higher major bleeding in <strong>gastrointestinal</strong> patients.</p>
            </div>
        </div>
    </div>

    <!-- Slide 8: Favoring Heparin -->
    <div class="slide" id="slide-7">
        <h2>When to Favor Heparin?</h2>
        <div class="data-grid">
            <div class="card">
                <h3>Clinical Scenarios</h3>
                <p>1. <strong>Luminal GI Cancer:</strong> Gastric or esophageal tumors (High bleeding risk).</p>
                <p>2. <strong>Absorption:</strong> Severe nausea, vomiting, or malabsorption.</p>
                <p>3. <strong>Interactions:</strong> Strong CYP3A4 inhibitors.</p>
            </div>
            <div class="card">
                <h3>Pharmacology</h3>
                <p>Low Molecular Weight Heparin is superior to Warfarin (CLOT Trial).</p>
                <p>Shorter half-life is safer for procedures or severe thrombocytopenia.</p>
            </div>
        </div>
    </div>

    <!-- Slide 9: Thrombocytopenia -->
    <div class="slide" id="slide-8">
        <h2>Thrombocytopenia Management</h2>
        <div class="card" style="margin-bottom: 10px;">
            <p><strong>Platelets > 50,000:</strong> Full therapeutic dose is safe.</p>
        </div>
        <div class="card" style="margin-bottom: 10px; border-color: var(--accent);">
            <p><strong>Platelets 20,000 - 50,000:</strong> Individualize; Consider <strong>50% dose reduction</strong> of Heparin.</p>
        </div>
        <div class="card" style="border-color: var(--danger); background: rgba(239, 68, 68, 0.1);">
            <p><strong>Platelets < 20,000:</strong> Typically Contraindicated.</p>
        </div>
    </div>

    <!-- Slide 10: Duration and De-escalation -->
    <div class="slide" id="slide-9">
        <h2>Duration and De-escalation</h2>
        <div class="data-grid">
            <div class="card">
                <h3>1. Acute Phase (0-6 Months)</h3>
                <p>Standard <strong>full-dose</strong> therapeutic treatment for any new clot.</p>
            </div>
            <div class="card">
                <h3>2. Active Phase (Indefinite)</h3>
                <p>Continue as long as cancer is <strong>active</strong> (metastatic or on treatment).</p>
            </div>
        </div>
        <div class="alert-box" style="border-color: var(--accent); margin-top: 15px;">
            <p style="font-size: 26px;"><strong>The API-CAT De-escalation Protocol:</strong></p>
            <p>After 6 months of success, switch to <strong>Apixaban 2.5mg twice daily</strong>. This maintains protection ("Insurance") while significantly lowering the risk of long-term bleeding.</p>
        </div>
    </div>

    <!-- Slide 11: Breakthrough Thrombosis -->
    <div class="slide" id="slide-10">
        <h2>Breakthrough Thrombosis Protocol</h2>
        <div class="card">
            <h3>Step 1: Failure on Oral Agents</h3>
            <p>Switch to <strong>Therapeutic-Dose Low Molecular Weight Heparin</strong> (Check adherence first).</p>
        </div>
        <div class="card" style="margin-top: 15px;">
            <h3>Step 2: Failure on Heparin</h3>
            <p>Escalate weight-based dose to <strong>120%</strong> or switch to <strong>every 12 hour</strong> dosing.</p>
            <p style="font-size: 22px; color: var(--text-dim);">Check <strong>Anti-Factor Xa levels</strong> to ensure therapeutic peak.</p>
        </div>
    </div>

    <!-- Slide 12: Renal & Obesity -->
    <div class="slide" id="slide-11">
        <h2>Renal and Obesity Nuance</h2>
        <div class="data-grid">
            <div class="card">
                <h3>Renal Impairment</h3>
                <p><strong>Clearance < 30:</strong> Avoid Direct Oral Anticoagulants. Use Unfractionated Heparin transitioning to Warfarin.</p>
            </div>
            <div class="card">
                <h3>Severe Obesity</h3>
                <p><strong>BMI > 40:</strong> Limited data for Direct Oral Anticoagulants. Warfarin preferred for reliable monitoring.</p>
            </div>
        </div>
    </div>

    <!-- Slide 13: Occult Malignancy Evaluation -->
    <div class="slide" id="slide-12">
        <h2>Evaluating Occult Malignancy</h2>
        <p>Indicated for <strong>Unprovoked</strong> events (Probability is highest in first 6 months).</p>
        <div class="card">
            <h3>Limited Evaluation Strategy</h3>
            <ul style="font-size: 24px; display: grid; grid-template-columns: 1fr 1fr;">
                <li><i class="fa-solid fa-check"></i> Comprehensive H&P</li>
                <li><i class="fa-solid fa-check"></i> CBC & Organ Tests</li>
                <li><i class="fa-solid fa-check"></i> Chest Radiograph</li>
                <li><i class="fa-solid fa-check"></i> Routine screening</li>
            </ul>
        </div>
        <div class="alert-box" style="border-color: var(--accent);">
            <p style="font-size: 22px;"><strong>Evidence Note:</strong> Extensive screening (Full-body CT/PET) has <strong>NOT</strong> shown a survival benefit over limited evaluation.</p>
        </div>
    </div>

    <!-- Slide 14: Summary -->
    <div class="slide" id="slide-13">
        <h2>Clinical Practice Summary</h2>
        <div class="bullet-list">
            <ul>
                <li><i class="fa-solid fa-circle-check"></i> <strong>Assess:</strong> Khorana Score for all outpatients starting chemo.</li>
                <li><i class="fa-solid fa-circle-check"></i> <strong>Treat:</strong> Apixaban is first-line; use Heparin for GI tumors.</li>
                <li><i class="fa-solid fa-circle-check"></i> <strong>Escalate:</strong> Use 120% dose Heparin for breakthrough events.</li>
                <li><i class="fa-solid fa-circle-check"></i> <strong>Extend:</strong> Indefinite duration for active malignancy; de-escalate at 6 months.</li>
            </ul>
        </div>
    </div>

    <div class="slide-counter" id="slide-count">SLIDE 1 OF 14</div>

    <div class="controls">
        <button class="nav-btn pen-btn" id="pen-toggle"><i class="fa-solid fa-pen-nib"></i> Red Pen</button>
        <button class="nav-btn pen-btn" id="pen-clear"><i class="fa-solid fa-eraser"></i> Clear</button>
        <div style="width: 2px; height: 100%; background: #475569; margin: 0 5px;"></div>
        <button class="nav-btn" id="prev-btn" disabled>Prev</button>
        <button class="nav-btn" id="next-btn">Next</button>
    </div>
</div>

<script>
    const slides = document.querySelectorAll('.slide');
    const nextBtn = document.getElementById('next-btn');
    const prevBtn = document.getElementById('prev-btn');
    const progressBar = document.getElementById('progress-bar');
    const slideCountText = document.getElementById('slide-count');
    const canvas = document.getElementById('drawing-canvas');
    const penToggle = document.getElementById('pen-toggle');
    const penClear = document.getElementById('pen-clear');
    const ctx = canvas.getContext('2d');
    
    let currentSlide = 0;
    let isDrawing = false;
    let penActive = false;

    function startDrawing(e) {
        if (!penActive) return;
        isDrawing = true;
        draw(e);
    }

    function stopDrawing() {
        isDrawing = false;
        ctx.beginPath();
    }

    function draw(e) {
        if (!isDrawing) return;
        const rect = canvas.getBoundingClientRect();
        const scaleX = canvas.width / rect.width;
        const scaleY = canvas.height / rect.height;
        const x = (e.clientX - rect.left) * scaleX;
        const y = (e.clientY - rect.top) * scaleY;

        ctx.lineWidth = 4;
        ctx.lineCap = 'round';
        ctx.strokeStyle = '#ef4444';
        ctx.lineTo(x, y);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x, y);
    }

    penToggle.addEventListener('click', () => {
        penActive = !penActive;
        penToggle.classList.toggle('active', penActive);
        canvas.style.pointerEvents = penActive ? 'all' : 'none';
    });

    penClear.addEventListener('click', () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    });

    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('mouseout', stopDrawing);

    function updatePresentation() {
        slides.forEach((slide, index) => {
            slide.classList.toggle('active', index === currentSlide);
        });

        prevBtn.disabled = currentSlide === 0;
        nextBtn.innerText = currentSlide === slides.length - 1 ? "Finish" : "Next";

        const progress = ((currentSlide + 1) / slides.length) * 100;
        progressBar.style.width = `${progress}%`;
        slideCountText.innerText = `SLIDE ${currentSlide + 1} OF ${slides.length}`;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    nextBtn.addEventListener('click', () => {
        if (currentSlide < slides.length - 1) {
            currentSlide++;
            updatePresentation();
        } else {
            currentSlide = 0;
            updatePresentation();
        }
    });

    prevBtn.addEventListener('click', () => {
        if (currentSlide > 0) {
            currentSlide--;
            updatePresentation();
        }
    });

    document.addEventListener('keydown', (e) => {
        if (penActive) return; 
        if (e.key === "ArrowRight" || e.key === " ") nextBtn.click();
        if (e.key === "ArrowLeft") prevBtn.click();
    });

    updatePresentation();
</script>

</body>
</html>
